# 风格指南

## 单一职责
对所有的组件、服务等等应用
单一职责原则(SRP)
。这样可以让应用更干净、更易读、更易维护、更易测试。

### 单一规则
风格 01-01
坚持每个文件只定义一样东西（例如服务或组件）。

考虑把文件大小限制在 400 行代码以内。

为何？单组件文件非常容易阅读、维护，并能防止在版本控制系统里与团队冲突。

为何？单组件文件可以防止一些隐蔽的程序缺陷，当把多个组件合写在同一个文件中时，可能造成共享变量、创建意外的闭包，或者与依赖之间产生意外耦合等情况。

为何？单独的组件通常是该文件默认的导出，可以用路由器实现按需加载。

最关键的是，可以让代码更加可复用、更容易阅读，减少出错的可能性。

### 小函数
风格 01-02
坚持定义简单函数

考虑限制在 75 行之内。

为何？简单函数更易于测试，特别是当它们只做一件事，只为一个目的服务时。

为何？简单函数促进代码复用。

为何？简单函数更易于阅读。

为何？简单函数更易于维护。

为何？小函数可避免易在大函数中产生的隐蔽性错误，例如与外界共享变量、创建意外的闭包或与依赖之间产生意外耦合等。

### 把逻辑放到服务里
风格 05-15
坚持在组件中只包含与视图相关的逻辑。所有其它逻辑都应该放到服务中。

坚持把可复用的逻辑放到服务中，保持组件简单，聚焦于它们预期目的。

为何？当逻辑被放置到服务里，并以函数的形式暴露时，可以被多个组件重复使用。

为何？在单元测试时，服务里的逻辑更容易被隔离。当组件中调用逻辑时，也很容易被模拟。

为何？从组件移除依赖并隐藏实现细节。

为何？保持组件苗条、精简和聚焦。

### 数据服务
通过服务与 Web 服务器通讯
风格 08-01
Style 08-01
坚持把数据操作和与数据交互的逻辑重构到服务里。

坚持让数据服务来负责 XHR 调用、本地储存、内存储存或者其它数据操作。

为何？组件的职责是为视图展示或收集信息。它不应该关心如何获取数据，它只需要知道向谁请求数据。把如何获取数据的逻辑移动到数据服务里，简化了组件，让其聚焦于视图。

为何？在测试使用数据服务的组件时，可以让数据调用更容易被测试（模拟或者真实）。

为何？数据管理的详情，比如头信息、方法、缓存、错误处理和重试逻辑，不是组件和其它的数据消费者应该关心的事情。

数据服务应该封装这些细节。这样，在服务内部修改细节，就不会影响到它的消费者。并且更容易通过实现一个模拟服务来对消费者进行测试。